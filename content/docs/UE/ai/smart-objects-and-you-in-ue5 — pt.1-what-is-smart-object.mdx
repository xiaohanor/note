---
title: Smart Objects and You in UE5 — Pt.1 What is Smart Object
---
[Sitemap](https://bigm227.medium.com/sitemap/sitemap.xml)

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*ySRkTJq70NLs5V8rfJwR6w.png)

Every game needs an interaction system.每个游戏都需要一个交互系统。\
Regardless if that is RPG, FPS, Racing Game etc.无论是 RPG、FPS、赛车游戏等。\
And making a good one is a hard thing to do, especially if you want ease of use, networking support and a good underlying architecture.制作一个好的是一件很难做到的事情，特别是如果你想要易用性、网络支持和良好的底层架构。

But with the release of Unreal Engine 5.0, Epic Games introduced their take on interaction system and solved most of the problems we all being bragging about, or did they?但随着虚幻引擎 5.0 的发布，Epic Games 引入了他们对交互系统的看法，并解决了我们都在吹嘘的大部分问题，他们解决了吗？

This is the first article of a mini-series “Smart Objects and You” in which we will cover the process of creating an interaction system from ground up based on Smart Objects both for AI and Players, talk about Networking and Replication caveats as well as some tips-n-tricks i learned along the way.这是迷你系列“智能对象和你”的第一篇文章，我们将介绍从头开始为 AI 和玩家创建基于智能对象的交互系统的过程，讨论网络和复制的注意事项以及我在此过程中学到的一些技巧。

In this part, I will give an overview of what “Smart Objects” are and how they work from the inside 在这一部分中，我将概述什么是“智能对象”以及它们如何从内部工作

The source code for this series will be available on GitHub.本系列的源代码将在 GitHub 上提供。\
Comments, suggestions and/or any form of discussion are always welcome.随时欢迎提出意见、建议和/或任何形式的讨论。

## So what are Smart Objects?那么什么是智能对象？ \[#so-what-are-smart-objects那么什么是智能对象]

Smart Objects provide interaction functionality for the actors that contain SmartObjectComponent, which points to smart object runtime object.智能对象为包含SmartObjectComponent的Actor提供交互功能，SmartObjectComponent指向智能对象运行时对象。

Smart objects are divided into slots that contain context for each interaction.智能对象被划分为包含每个交互上下文的插槽。

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*9RGtNfUvnYB-JyJvLfVfcw.png)

Slots on a Smart Object Actor

Each slot has its own state, as well as the action that player has to execute when he uses the slot. 每个插槽都有自己的状态，以及玩家在使用插槽时必须执行的作。\
Those could be either playing an animation, executing Behavior Tree or some custom defined logic.这些可以是播放动画、执行行为树或一些自定义定义的逻辑。

And the states represent the availability of Smart Object — as you can see on the picture below.这些状态代表智能对象的可用性——如下图所示。

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*GnGBrKo40OpShyGl2TPWTw.gif)

AI only requests to receive presents when it is fully “seated” at the table, and stops the requests for the Table when leaves

> **Red(Used)** — Smart Object is occupied\
> **Yellow(Claimed)-** player reserved this slot, but didn’t arrive at the position of the slot yet.\
> **Green(Free)** — the slot is free and can be queried and used.红色（已使用） — 智能对象被占用 黄色（已认领）- 玩家保留了这个插槽，但尚未到达插槽的位置。 绿色（Free） — 插槽是空闲的，可以查询和使用。

To define Smart Object you’d need to create a **Smart Object definition** — an asset which basically defines rules that will apply to Smart Object when using it, as well as the slots, their position, actions they will trigger, selection conditions etc.要定义智能对象，您需要创建一个智能对象定义——一个资产，它基本上定义了使用智能对象时将应用于智能对象的规则，以及插槽、它们的位置、它们将触发的作、选择条件等。

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*Va0yz_a6pqzqbe1eUiNzTw.png)

Smart Object Definition Editor

Slots also can also have additional data defined as custom **FSmartObjectSlotDefinitionData** and put into Data array.插槽还可以将其他数据定义为自定义 FSmartObjectSlotDefinitionData 并放入 Data 数组中。

## Under the hood引擎盖下 \[#under-the-hood引擎盖下]

Under the hood, Smart Objects use spatial database to partition and search using actors bounds to determine the closest Smart Object and slot to the querier.在幕后，智能对象使用空间数据库使用actor边界进行分区和搜索，以确定距离查询器最近的智能对象和插槽。

There are two aviliable USmartObjectSpacePartition classes - **USmartObjectOctree** or **USmartObjectHashGrid**\
They currently default to Spatial Hash Grid implementation, although, this can be changed in config.它们目前默认为空间哈希网格实现，不过，这可以在配置中更改。 有两个可用的 USmartObjectSpacePartition 类 - USmartObjectOctree 或 USmartObjectHashGrid

![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*JAF1UcWnfTqGtQ2yFC1Q9g.png)

Bounds used in SmartObjectSpacePartition(highlited in blue)

After the spatial search, Smart Objects are filtered using 空间搜索后，将使用

1. **Selection Preconditions** — user defined functors, which are used to filter out SO on specific condition. They inherit FWorldConditionBase class, and use World Conditions plugin to handle all condition logic.选择先决条件 — 用户定义的函子，用于在特定条件下过滤掉 SO。它们继承了 FWorldConditionBase 类，并使用 World Conditions 插件来处理所有条件逻辑。
2. **User tags —** tags user must inherit to use this specific SO 用户标签 — 用户必须继承才能使用此特定 SO 的标签
3. **Activity tags** — optional tags that distinguish SO, only used during the search 活动标记 - 区分 SO 的可选标记，仅在搜索期间使用
   ![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*Bd_KwDSlDZT3Uvm6hMqinA.png)

SmartObject use scenario flow

There’s are also two other frameworks that come to play, when it comes to smart objects — 当涉及到智能对象时，还有另外两个框架开始发挥作用——

1. **MASS, which is used for data storage MASS，用于数据存储**
2. **Gameplay Behaviours, which is used for scripted actions Gameplay行为，用于脚本化作**
   ![](https://miro.medium.com/v2/resize:fit:640/format:webp/1*AlmTXjHzrFdr-3LHrhIzZg.png)

### MASS质量 \[#mass质量]

MASS — is an ECS framework inside of Unreal Engine. Specifically Mass Gameplay plugin, as the MASS framework is split into different plugins for crowd control etc.MASS——是虚幻引擎中的一个ECS框架。特别是 Mass Gameplay 插件，因为 MASS 框架被拆分为不同的插件，用于人群控制等。

So Mass Gameplay, being an ECS system, introduces things called “Mass Fragments”, which could be explained in two words — “data containers” 因此，Mass Gameplay 作为一个 ECS 系统，引入了称为“Mass Fragments”的东西，可以用两个词来解释——“数据容器”\
Though this explanation may not be really correct, but you get the point 虽然这个解释可能并不真正正确，但你明白了这一点

And as you may already guessed, Smart Objects use Mass Fragments as their data storage.正如您可能已经猜到的那样，智能对象使用海量片段作为其数据存储。\
Every data, that is tied to Smart Objects at runtime, is represented as a **FMassFragment**.在运行时与智能对象绑定的每个数据都表示为 FMassFragment。

The main reason for this is it’s efficiency. Storing large amount of runtime data is mandatory, as smart objects contain a lot of metadata junk that is persistent at runtime.造成这种情况的主要原因是它的效率。存储大量运行时数据是强制性的，因为智能对象包含大量在运行时持久存在的元数据垃圾。

If you’d like to read more about MASS, I have a links to some amazing documentation from Unreal community below.如果你想了解更多关于MASS的信息，我在下面提供了虚幻社区的一些精彩文档的链接。

### Gameplay Behaviors游戏行为 \[#gameplay-behaviors游戏行为]

Though being a separate plugin, those are basically “AI Tasks for Smart Objects”.虽然是一个单独的插件，但这些基本上是“智能对象的 AI 任务”。\
Anyone who had experience using BTTasks or Gameplay Abilities, could see some simularities between the two.任何有使用 BTTask 或 Gameplay Abilities 经验的人都可以看到两者之间的一些相似之处。

Gameplay Behaviors represent incapsulated logic, which will be executed when smart object is being used by Character.Gameplay行为表示封装逻辑，当角色使用智能对象时，将执行该逻辑。

## Player or AI玩家或 AI \[#player-or-ai玩家或-ai]

If you seen the City Sample project, you probably won’t be surprised to learn that Smart Object implementation there is only meant for AI.如果你看过城市示例项目，你可能不会惊讶地发现，智能对象实现仅适用于人工智能。

As a matter of fact, all of Smart Object system is mostly build around AI use only.事实上，所有智能对象系统大多都是围绕人工智能使用构建的。\
Still there is no blockers which prevent you from using this on Player characters.仍然没有阻止措施阻止您在玩家角色上使用它。

The only thing to keep in mind, that replication support for SmartObjects, is really limited. The main bottlenack being the FMassFragments that store smart object data.唯一要记住的是，对 SmartObjects 的复制支持确实有限。主要的瓶颈是存储智能对象数据的 FMassFragments。\
As of UE 5.2 those are not replicated.从 UE 5.2 开始，这些不会被复制。

Still, there are ways to replicate some data you may need from Smart Object system.不过，还是有一些方法可以从智能对象系统复制您可能需要的一些数据。\
We will cover the replication and Player usage in the next part of the series.我们将在本系列的下一部分中介绍复制和播放器的使用情况。

And as for today, this is it.至于今天，就是这样。\
In the next part we are going to cover Gameplay Behaviours and Smart Object data storing.在下一部分中，我们将介绍游戏行为和智能对象数据存储。

## Useful links有用的链接 \[#useful-links有用的链接]

Github — [https://github.com/LeonovOstap/SmartObjectsUE](https://github.com/LeonovOstap/SmartObjectsUE) Github — https://github.com/LeonovOstap/SmartObjectsUE

Mass Community Sample by namo, check it out for some info on Mass aswell as ECS in general— [https://github.com/getnamo/MassCommunitySample](https://github.com/getnamo/MassCommunitySample) namo 的 Mass 社区样本，查看有关 Mass 以及一般 ECS 的一些信息 — https://github.com/getnamo/MassCommunitySample
